# Trading Simulation Scripts

## Overview
The trading simulation has been split into two separate Python scripts for better organization and functionality:

2. **`excel-simulation.py`** - Enhanced Excel simulation with configurable parameters
3. **`multi-seed-simulation.py`** - Multi-seed analysis to determine best performing strategy

## Script Descriptions

### `excel-simulation.py`
- **Purpose**: Enhanced Excel simulation with configurable parameters
- **Features**: 
  - Configurable seed, capital, trades, risk parameters
  - Optional Excel output
  - Function-based design for reusability
  - Colorful terminal output for better readability
- **Usage**: `python excel-simulation.py` or import functions

### `multi-seed-simulation.py`
- **Purpose**: Multi-seed analysis to determine best performing strategy
- **Features**: 
  - Tests multiple seeds (default: 50) with 100 trades each
  - Comprehensive statistical analysis
  - Multiple ranking criteria
  - Best strategy identification
  - Colorful terminal output with progress indicators
  - Medal emojis (ü•áü•àü•â) for rankings
- **Usage**: `python multi-seed-simulation.py` or import functions

## Functions in excel-simulation.py

### `run_excel_simulation()`
- **Purpose**: Run a single trading simulation and optionally save to Excel
- **Parameters**:
  - `seed`: Random seed for reproducibility (default: 552)
  - `starting_capital`: Starting capital amount (default: $10,000)
  - `n_trades`: Number of trades to simulate (default: 100)
  - `base_risk_pct`: Base risk percentage per trade (default: 1%)
  - `win_prob`: Probability of winning a trade (default: 45%)
  - `reward_factor`: Reward factor for winning trades (default: 1.5)
  - `step_pct`: Step percentage for martingale strategies (default: 1%)
  - `save_excel`: Whether to save results to Excel file (default: True)
  - `output_dir`: Directory to save Excel file (default: "./")

## Functions in multi-seed-simulation.py

### `run_multi_seed_simulation()`
- **Purpose**: Runs multiple trading simulations with different random seeds
- **Parameters**:
  - `num_seeds`: Number of different seeds to test (default: 50)
  - `n_trades`: Number of trades per simulation (default: 100)
  - `starting_capital`: Starting capital (default: $10,000)
  - `base_risk_pct`: Base risk percentage (default: 1%)
  - `win_prob`: Win probability (default: 45%)
  - `reward_factor`: Reward factor for winners (default: 1.5)
  - `step_pct`: Step percentage for martingale strategies (default: 1%)

### `analyze_strategy_performance()`
- **Purpose**: Analyzes and compares strategy performance across all seeds
- **Features**:
  - Calculates comprehensive statistics for each strategy
  - Provides multiple ranking criteria
  - Identifies the best performing strategy

## Performance Metrics Analyzed

1. **Average Return**: Mean return percentage across all seeds
2. **Median Return**: Median return (more robust to outliers)
3. **Standard Deviation**: Volatility of returns
4. **Return Range**: Min and max returns observed
5. **Positive Return Rate**: Percentage of seeds with positive returns
6. **High Return Rate**: Percentage of seeds with returns > 10%
7. **Average Max Drawdown**: Average maximum drawdown experienced
8. **Risk-Adjusted Return**: Return divided by drawdown

## Ranking Criteria

The system provides rankings based on:
1. Average Return
2. Median Return (more robust)
3. Positive Return Rate
4. Risk-Adjusted Return (return/drawdown ratio)

## Usage Examples

### Excel Simulation
```python

# Run enhanced Excel simulation with custom parameters
python excel-simulation.py

# Or import and use functions
from excel_simulation import run_excel_simulation
results = run_excel_simulation(
    seed=123,
    starting_capital=50000,
    n_trades=200,
    win_prob=0.40
)
```

### Multi-Seed Analysis
```python
# Run with default parameters (50 seeds, 100 trades each)
python multi-seed-simulation.py

# Or import and use functions
from multi_seed_simulation import run_multi_seed_simulation
results = run_multi_seed_simulation()

# Get the best strategy
best_strategy = results['best_strategy']
print(f"Best Strategy: {best_strategy}")
```

### Custom Multi-Seed Parameters
```python
# Run with custom parameters
results = run_multi_seed_simulation(
    num_seeds=100,      # Test 100 different seeds
    n_trades=200,       # 200 trades per simulation
    starting_capital=50000,  # Start with $50,000
    win_prob=0.40       # 40% win probability
)
```

### Access Detailed Results
```python
results = run_multi_seed_simulation()

# Access strategy summaries
strategy_summary = results['strategy_summary']
for strategy, stats in strategy_summary.items():
    print(f"{strategy}: {stats['avg_return']:.2f}% avg return")

# Access rankings
rankings = results['rankings']
print("Best by average return:", rankings['avg_return'][0][0])
print("Best by median return:", rankings['median_return'][0][0])
```

## Benefits

1. **Statistical Robustness**: Tests strategies across many different market scenarios
2. **Risk Assessment**: Provides comprehensive risk metrics including drawdowns
3. **Multiple Perspectives**: Ranks strategies by different criteria
4. **Confidence**: Shows how often each strategy produces positive returns
5. **Outlier Detection**: Identifies strategies that work well on average vs. consistently

## Output Example

The simulation provides detailed output including:
- Progress indicators during execution
- Detailed statistics for each strategy
- Multiple ranking systems
- Overall recommendation with key metrics
- üèÜ Clear identification of the best performing strategy

This feature helps make data-driven decisions about which trading strategy to use based on comprehensive statistical analysis rather than single simulation results.
